TODO:
1. Run updated code from test project and verify success. 
2. Move updated code from test project back to the main project
3. Write DLL export sections
4. Provide for logging to the event viewer. 